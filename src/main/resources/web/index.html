<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.3, user-scalable=yes">
    <title>JUnit Web Launcher</title>
    <link rel="stylesheet" href="lib/pico.min.css"/>
    <script defer src="lib/alpinejs.cdn.min.js"></script>
    <script>
        const protocol = location.protocol == "https:" ? "wss:" : "ws:";
        const socket = new WebSocket(protocol + "//" + location.host);
        socket.onmessage = event => {
          const message = document.createElement("div");
          message.textContent = event.data;
          document.getElementById("messages").appendChild(message);
        };
        function sendMessage(event) {
          event.preventDefault();
          const input = document.getElementById("messageInput");
          socket.send("startParams=" + input.value);
          input.value = "";
        };
        function clearMessages() {
          document.getElementById("messages").innerHTML = "";
        }
    </script>

    <script src="main.js"></script>
    <style>
        .no-underline a {
          text-decoration: none
        }
        dialog article {
            max-width: 1000px;
        }
        :root {
            --pico-font-size: 100%;
        }
    </style>
</head>

<body>

<div class="container-fluid">
    <nav>
        <ul>
            <li>
                <h1>JUnit Web Launcher</h1>
            </li>
        </ul>
        <ul>
            <li><a role="button" href="./log/" target="_blank">View Log Files</a></li>
        </ul>
    </nav>
</div>

<div class="grid" x-data="testMethodData" @runTestMethods="runTestMethods">
    <article>
        <header><strong>Available Test Classes / Methods</strong></header>
        <form>
            <fieldset class="grid">
                <input type="text" x-model="availableFilterKeyword" size="50" @input.debounce.200ms="filterAvailableTestMethods" placeholder="filter" />
                <input type="button" class="secondary" @click.prevent="addToSelectedTestMethods" value="Add" />
            </fieldset>
            <table class="striped">
                <thead>
                <tr>
                    <th scope="col"><input type="checkbox" id="toggleAllAvailable" @change="toggleAllAvailableFilteredMethods($event.target.checked)" x-bind:checked="availableCheckedIds.length >0" /></th>
                    <th scope="col">className</th>
                    <th scope="col">methodName</th>
                </tr>
                </thead>
                <tbody>
                <template x-for="(item, index) in availableFilteredMethods">
                    <tr>
                        <td>
                            <input type="checkbox" x-model="availableCheckedIds" x-bind:value="item.fullyQualifiedMethodName"/>
                        </td>
                        <td x-text="item.className"></td>
                        <td x-text="item.methodName"></td>
                    </tr>
                </template>
                </tbody>
            </table>
        </form>
    </article>
    <article x-show="selectedTestMethods.length > 0" x-transition.duration.1000ms >
        <header><strong>Selected Test Classes / Methods: <span x-text="selectedTestMethods.length"></span></strong></header>
        <form>
            <fieldset class="grid">
                <input type="text" x-model="selectedFilterKeyword" size="50" @input.debounce.200ms="filterSelectedTestMethods" placeholder="filter" x-show="isEditMode" />
                <input type="button" class="secondary" @click.prevent="isEditMode = true" value="Edit" x-show="!isEditMode" />
                <input type="button" class="secondary" @click.prevent="removeFromSelectedTestMethods" value="Remove" x-show="isEditMode"/>
                <input type="button" class="secondary" @click.prevent="isEditMode = false" value="Complete Editing" x-show="isEditMode" />
                <input type="button" @click.prevent="runTestMethods" value="Run" />
            </fieldset>
            <table class="striped">
                <thead>
                <tr>
                    <th scope="col"x-show="isEditMode"><input type="checkbox" id="toggleAllSelected" @change="toggleAllSelectedFilteredMethods($event.target.checked)"  x-bind:checked="selectedCheckedIds.length >0" /></th>
                    <th scope="col">className</th>
                    <th scope="col">methodName</th>
                </tr>
                </thead>
                <tbody>
                <template x-for="(item, index) in selectedFilteredMethods">
                    <tr>
                        <td x-show="isEditMode">
                            <input type="checkbox" x-model="selectedCheckedIds" x-bind:value="item.fullyQualifiedMethodName"/>
                        </td>
                        <td x-text="item.className"></td>
                        <td x-text="item.methodName"></td>
                    </tr>
                </template>
                </tbody>
            </table>
        </form>
    </article>
</div>

<div style="padding:1rem;font-size:1rem">
    <pre id="messages" style="white-space:pre-wrap"></pre>
</div>
</body>

</html>
